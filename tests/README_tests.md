## Тесты GrabVidZilla

В этой директории находятся вспомогательные тесты проекта, включая smoke‑тест CLI.

### Smoke‑тест CLI (`tests/smoke_cli.py`)

Назначение: прогнать список тестовых ссылок через существующий CLI как «чёрный ящик» и получить понятный отчёт об успехах/ошибках.

- Взаимодействие идёт только через запуск процесса: `python -m cli.cli ...` или бинарь `grabvidzilla` (если установлен и передан флаг `--use-binary`).
- Рабочая директория — корень проекта. Скрипт сам указывает `cwd`.
- Список ссылок редактируется в начале файла `tests/smoke_cli.py` в словаре `TEST_URLS`:

```python
TEST_URLS = {
    "youtube_ok": "https://...",
    "vk_ok": "https://...",
    "rutube_ok": "https://...",
    # добавляйте/меняйте ссылки здесь
}
```

#### Запуск

Запускать из корня репозитория:

```bash
python tests/smoke_cli.py
```

Полезные варианты:

- Использовать установленный бинарь `grabvidzilla` (вместо `python -m cli.cli`):

```bash
python tests/smoke_cli.py --use-binary
```

- Указать папку для загрузок (иначе будет использована `Downloads/temp`):

```bash
python tests/smoke_cli.py --output Downloads
```

- Запуск как модуль:

```bash
python -m tests.smoke_cli
```

#### Куда скачиваются файлы

- По умолчанию: в `Downloads/temp` внутри корня проекта (создаётся автоматически).
- Если передать `--output <путь>` — скачивание идёт строго в указанный путь.

Поведение очистки:

- Если все кейсы прошли успешно — папка по умолчанию (`Downloads/temp`) будет удалена.
- Если были ошибки — папка останется, путь выводится в финальном сообщении.
- Переданный пользователем `--output` никогда автоматически не удаляется.

#### Отчёт и коды возврата

В конце скрипт печатает сводную таблицу вида:

```
=== ИТОГОВЫЙ ОТЧЁТ ===
OK   | youtube_ok | 12.3 c | https://...
FAIL | vk_ok      |  5.1 c | https://...
```

- Выход 0 — все кейсы OK.
- Выход 1 — есть хотя бы один FAIL.

#### Частые проблемы

- Не установлен `ffmpeg` или он не в PATH — CLI упадёт.
- Отсутствует сеть/ограничения по провайдеру/региону — возможны FAIL.
- Для `--use-binary` бинарь `grabvidzilla` должен быть доступен в PATH (`grabvidzilla --help`).

#### Мини‑чеклист перед запуском

- Python 3.11+ установлен.
- `ffmpeg` доступен в PATH.
- Достаточно свободного места в `Downloads/` или переданной папке.


